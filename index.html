<style>
body {
	background:url(images/sunset.jpg) no-repeat center center fixed; 
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover;
}
h1, h2 { margin:auto; text-align:center; }

h1 {
color:white;
text-shadow:#000 2px 2px;
font-family:Georgia;
font-size:4em;
}

h2 {
color:#fff;
text-shadow:#666 2px 0 1px;
}

h2.choose {
left: 24px;
position: absolute;
}

.spacedrum {
width:300px;
height:300px;
margin:120px auto;
position:relative;
}

.spacedrum6 { background: url('images/6notes-play.png') }
.spacedrum8 { background: url('images/8notes-play.png'); width: 315px; height: 315px; display:none; }
.spacedrum13 { background: url('images/13notes-play.png'); width: 350px;
height: 350px; display:none; margin:60px auto; }

.select-drum { position:absolute; top:5%; }

.list { width:130px; height:80px; cursor:pointer; list-style: none; margin:10px;}

.list-spacedrum6 { background: url('images/6notes.png'); }
.list-spacedrum8 { background: url('images/8notes.png') no-repeat; height:90px; }
.list-spacedrum13 { background: url('images/13notes.png'); }
img.keyboard { position:absolute; top: 13%; right: 25%; opacity:0.75}

button {
width: 60px;
height: 60px;
border-radius: 25px;
cursor: pointer;
position:absolute;
opacity:0;
}

.spacedrum13 button { width: 55px; height: 55px; }

.spacedrum13 button { width: 50px; height: 50px; }

/* 6 NOTES */
#Bb3V4 { top: 37%; right: 38%; }
#C4V4 { bottom: 16%; left: 18%; }
#D4V4 { left: 63%; top: 64%; }
#F4V4 { top: 23%; left: 11%;}
#G4V4 { top: 26%; left: 71%; }
#Bb4V4 { top: 6%; left: 43%; }

/* 8 NOTES */
#V4A3 {left: 38%; top: 39%;}
#V4B3 {bottom: 11%; left: 21%;}
#V4C4 {right: 23%; bottom: 11%;}
#V4D4 {left: 5%; top: 41%;}
#V4E4 {right: 5%; top: 40%;}
#V4F4 {top: 12%; left: 18%;}
#V4G4 {right: 18%; top: 13%;}
#V4A4 {top: 6%; left: 40%;}

/* 13 NOTES */
#o1C4 {right: 23%; bottom: 11%;}
#o2Cd4 {top: 22%; right: 14%;}
#o3D4 {right: 49%; bottom: 9%;}
#o4Eb4 {left: 27%; top: 23%;}
#o5E4 {right: 5%; bottom: 26%;}
#o6F4 {top: 63%; left: 20%;}
#o7Fd4 {right: 38%; top: 13%;}
#o8G4 {top: 39%; right: 4%;}
#omaGd4 {top: 43%; left: 17%;}
#o10A4 {bottom: 25%; right: 35%;}
#o11Bb4 {top: 34%; left: 50%;}
#o12B4 {top: 47%; right: 19%;}
#o13C5 {top: 48%; left: 34%;}
</style>

<body>
	<h2 class="choose">select instrument</h2>
	<ul class="select-drum">
		<li class="list list-spacedrum6" title="6 notes"></li>
		<li class="list list-spacedrum8" title="8 notes"></li>
		<li class="list list-spacedrum13" title="13 notes"></li>
	</ul>
	<h1>spacedrum!</h1>
	<h2>hover the instrument to play or</h2>
	<img class="keyboard" src="images/keyboard6.png"/>
	<div class="spacedrum spacedrum6">
		<button id="C4V4"></button>
		<button id="Bb3V4"></button>
		<button id="D4V4"></button>
		<button id="F4V4"></button>
		<button id="G4V4"></button>
		<button id="Bb4V4"></button>
	</div>

	<div class="spacedrum spacedrum8">
		<button id="V4A3"></button>
		<button id="V4B3"></button>
		<button id="V4C4"></button>
		<button id="V4D4"></button>
		<button id="V4E4"></button>
		<button id="V4F4"></button>
		<button id="V4G4"></button>
		<button id="V4A4"></button>
	</div>

	<div class="spacedrum spacedrum13">
		<button id="o1C4"></button>
		<button id="o2Cd4"></button>
		<button id="o3D4"></button>
		<button id="o4Eb4"></button>
		<button id="o5E4"></button>
		<button id="o6F4"></button>
		<button id="o7Fd4"></button>
		<button id="o8G4"></button>
		<button id="omaGd4"></button>
		<button id="o10A4"></button>
		<button id="o11Bb4"></button>
		<button id="o12B4"></button>
		<button id="o13C5"></button>
	</div>
	<a href="https://github.com/you"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
</body>

<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
AudioContext = window.AudioContext || window.webkitAudioContext;
SpaceDrum = {
	audioContext: new AudioContext(),
	sounds: {},
	parent: null,
	load: function() {
		this.notes = [];
		var that = this;
		$.each(that.parent.find('button'), function(key,value){
			that.notes.push( $(value).attr('id') );
		});
		this.loadSounds(this.audioContext);
		this.parent.find('button').mouseenter(function(){
			SpaceDrum.playSound($(this).attr('id'));
		});
		document.onkeydown = function(e)  {
			kc = e.keyCode;
			if(kc in that.keyBindings) {
				SpaceDrum.playSound( that.keyBindings[kc] );
			}
		}
	},
	loadSound: function (audioContext, key, url) {
	    var request = new XMLHttpRequest(),
	    	dfd = $.Deferred();
	    request.open("get", url);
	    request.responseType = "arraybuffer";
	    request.onload = (function () {
	      this.audioContext.decodeAudioData(request.response, (function (buffer) {
	        this.sounds[key] = buffer;
	        dfd.resolve();
	      }).bind(this));
	    }).bind(this);
	    request.send();
	    return dfd;
	},
	loadSounds: function (audioContext) {
	    var dfds = [],
	    	that = this,
	    	masterDfd = $.Deferred();
	    for (var key in this.notes) {
	    	var note = this.notes[key];
	        dfds.push(
	       	  this.loadSound(audioContext,
			     note,
			     that.path+note+'.mp3'
		      )
		    );
	    }

	    $.when.apply($, dfds).then(function () {
	      masterDfd.resolve();
	    });

	    return masterDfd;
	},
	playSound: function(sound) {
		var element = $('#'+sound);
		element.css('opacity', '0.5');
		element.animate({opacity: 0}, 'fast');
	    var source = this.audioContext.createBufferSource();
	    source.buffer = this.sounds[sound];
	    source.connect(this.audioContext.destination);
	    source.start(0);
	}
};

var SpaceDrum6 = $.extend({}, SpaceDrum);
var SpaceDrum8 = $.extend({}, SpaceDrum);
var SpaceDrum13 = $.extend({}, SpaceDrum);
SpaceDrum6.keyBindings = {
	'90': 'C4V4',
	'65': 'F4V4',
	'68': 'G4V4',
	'88': 'D4V4',
	'87': 'Bb4V4',
	'83': 'Bb3V4',
}
SpaceDrum6.path = 'sounds/6notes';
SpaceDrum6.parent = $('.spacedrum6');
SpaceDrum8.keyBindings = {
	'51': 'V4A4',
	'87': 'V4F4',
	'69': 'V4G4',
	'68': 'V4E4',
	'88': 'V4C4',
	'90': 'V4B3',
	'65': 'V4D4',
	'83': 'V4A3',
}
SpaceDrum8.path = 'sounds/8notesDiatoAm';
SpaceDrum8.parent = $('.spacedrum8');
SpaceDrum13.keyBindings = {
		"67":'o1C4',
		"52":'o2Cd4',
		"88":'o3D4',
		"87":'o4Eb4',
		"70":'o5E4',
		"90":'o6F4',
		"51":'o7Fd4',
		"84":'o8G4',
		"65":'omaGd4',
		"68":'o10A4',
		"69":'o11Bb4',
		"82":'o12B4',
		"83":'o13C5',
}
SpaceDrum13.path = 'sounds/Chr';
SpaceDrum13.parent = $('.spacedrum13');
SpaceDrum6.load();

$('.list-spacedrum6').click(function(){
	SpaceDrum6.load();
	$('body').animate({opacity: 0}, 'slow', function() {
		$('img.keyboard').attr('src', 'images/keyboard6.png');
		$('.spacedrum').hide();
        $(this).
        	css({'background-image': 'url(images/sunset.jpg)'}).
            animate({opacity: 1});
        $('.spacedrum6').show();
        
    });
});

$('.list-spacedrum8').click(function(){
	SpaceDrum8.load();
	$('body').animate({opacity: 0}, 'slow', function() {
		$('img.keyboard').attr('src', 'images/keyboard8.png');
		$('.spacedrum').hide();
        $(this).
        	css({'background-image': 'url(images/magnaen.jpg)'}).
            animate({opacity: 1});
        $('.spacedrum8').show();

    });
});

$('.list-spacedrum13').click(function(){
	SpaceDrum13.load();
	$('body').animate({opacity: 0}, 'slow', function() {
		$('.spacedrum').hide();
		$('img.keyboard').attr('src', 'images/keyboard13.png');
        $(this).
        	css({'background-image': 'url(images/hands.jpg)'}).
            animate({opacity: 1});
        $('.spacedrum13').show();
        
    });
});
</script>
<script type="text/javascript">
// $.each($('button'), function(){
// 	var $this = $(this);
// 	$this.text( $this.attr('id') );
// })
</script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-13230251-1']);
  _gaq.push(['_setDomainName', 'diofeher.net']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
